{"content":"<h2 id=\"mu\">Mở đầu</h2><p>Clean code luôn là một vấn đề được các dev quan tâm đặc biệt với những người đi làm. Bạn có bao giờ bực bội với mớ code hỗn độn không được format, những dòng code viết ra nhưng không bao giờ sử dụng để rồi việc đọc code khó khăn hơn bao giờ hết. <strong>Bài viết này sẽ đề xuất cách để bạn làm cho những dòng code của mình clean nhất có thể trong Angular nhé.</strong></p><p><img src=\"https://images.viblo.asia/c70858c6-5ad0-4891-b58f-0af5af9cd763.jpg\" alt=\"\" /></p><h2 id=\"nidung\">Nội dung</h2><h3 id=\"1hybtuvivictomtngdngangular\"><strong>1. Hãy bắt đầu với việc tạo một ứng dụng Angular:</strong></h3><ul><li>Cài đặt biến toàn cầu:</li></ul><pre><code>    npm install -g @angular/cli<br/></code></pre><ul><li>Cài đặt ứng dụng angular:</li></ul><pre><code>    ng new clean-code-angular<br/></code></pre><ul><li>Sau đó chọn các tùy chọn và tiến hành cài đặt.</li></ul><h3 id=\"2tinhnhconfigureproject\"><strong>2. Tiến hành configure project:</strong></h3><h4 id=\"citchocodeeditor\">Cài đặt cho code editor:</h4><ul><li>Ở đây mình sử dụng VSCode làm code editor. Chúng ta sẽ cài đặt 2 extensions là <code>ESLint</code> và <code>Prettier - Code formatter</code>.</li><li>Đặt prettier làm trình format code mặc định bằng cách gõ <code>Ctrl + Shift + P</code>, tìm <code>Format document with...</code> và chọn <code>Prettier - Code Formatter</code> làm mặc định.</li><li>Cài đặt tự động format code khi lưu code bằng cách gõ <code>Ctrl + Shift + P</code>, tìm <code>Open User Settings (JSON)</code> và thêm đoạn code sau và lưu lại:</li></ul><pre><code>    {<br/>        // các cài đặt khác,<br/>        \"editor.formatOnSave\": true,<br/>    }<br/></code></pre><p>#### Configure cho project</p><ul><li>Cài đặt Angular ESLint:</li></ul><pre><code>    ng add @angular-eslint/schematics<br/></code></pre><ul><li>Cài đặt prettier:</li></ul><pre><code>    npm i prettier eslint-config-prettier eslint-plugin-prettier -D<br/></code></pre><ul><li>Chỉnh sửa file <code>.eslintrc.json</code> như sau:</li></ul><pre><code>    \"extends\": [<br/>        \"eslint:recommended\",<br/>        \"plugin:@typescript-eslint/recommended\",<br/>        \"plugin:@angular-eslint/recommended\",<br/>        \"plugin:@angular-eslint/template/process-inline-templates\",<br/>        // setting for prettier<br/>        \"plugin:prettier/recommended\"<br/>      ],<br/></code></pre><ul><li>Tạo file <code>.prettierrc.json</code> trong thư mục gốc:</li></ul><pre><code>    {<br/>      \"useTabs\": false,<br/>      \"singleQuote\": false,<br/>      \"tabWidth\": 2,<br/>      \"printWidth\": 80,<br/>      \"semi\": true,<br/>      \"bracketSpacing\": true,<br/>      \"trailingComma\": \"es5\",<br/>      \"htmlWhitespaceSensitivity\": \"ignore\",<br/>      \"overrides\": [<br/>        {<br/>          \"files\": \"*.html\",<br/>          \"options\": {<br/>            \"parser\": \"angular\"<br/>          }<br/>        }<br/>      ],<br/>      \"endOfLine\": \"auto\"<br/>    }<br/></code></pre><ul><li>Bây giờ hãy thử chạy <code>npm run lint</code> thì bạn sẽ thấy có lỗi tương tự như này:</li></ul><p><img src=\"https://images.viblo.asia/aea5deab-4f94-48ed-a63f-308d01c00f25.png\" alt=\"\" /></p><p>=&gt; Hãy đi sửa nó nhé:</p><ul><li>Cập nhật <code>package.json</code> như sau: </li></ul><pre><code>    \"scripts\": {<br/>       // some code<br/>       ...<br/>        \"lint\": \"ng lint\",<br/>        \"lint:fix\": \"prettier --write src &amp;amp;&amp;amp; ng lint --fix\"<br/>  },<br/></code></pre><ul><li>Chạy <code>npm run lint:fix</code>, sau đó kiểm tra lại bằng lệnh <code>npm run lint</code> được kết quả như sau:</li></ul><p><img src=\"https://images.viblo.asia/1127e035-da45-412c-a5f0-2d6762769930.png\" alt=\"\" /></p><ul><li>Như vậy là code của bạn đã được format lại rồi, hãy kiểm tra xem những thay đổi trong source code nhé.</li></ul><h4 id=\"bygisnngcaohnmtxunh\">Bây giờ sẽ nâng cao hơn một xíu nhé</h4><p>Ví dụ bạn có một team code với nhau một project thì sẽ phải đẩy code lên git và lỡ như thành viên nào đó đẩy code của được format đúng lên git thì sao? Khi đó chúng ta sẽ phải chặn việc commit code nếu code chưa được format. Hãy tiếp tục configure project như sau:</p><ul><li><strong>Configure Git Hooks</strong>:</li></ul><pre><code>    npm i husky lint-staged -D<br/></code></pre><pre><code>    npx husky-init<br/></code></pre><ul><li>Trong thư mục <code>.husky</code> mới được tạo, chỉnh sửa file <code>pre-commit</code> như sau:</li></ul><pre><code>    #!/usr/bin/env sh<br/>    . \"$(dirname -- \"$0\")/_/husky.sh\"<br/>    npx lint-staged<br/></code></pre><ul><li>Thêm đoạn code sau vào <code>package.json</code>:</li></ul><pre><code>    {<br/>        // some code <br/>        ...<br/>        \"lint-staged\": {<br/>            \"src/**/*.{js,ts,html,css,scss}\": [<br/>              \"prettier --write\",<br/>              \"eslint --max-warnings=0\"<br/>            ]<br/>          }<br/>    }<br/></code></pre><ul><li>Vậy là đã xong, ở đây mình cố ý để lỗi eslint như sau:</li></ul><p><img src=\"https://images.viblo.asia/2914dfd2-fb66-4c4a-b85d-9ad1e905b68f.png\" alt=\"\" /></p><ul><li>Khi đó nếu mình chạy <code>npm run lint</code> sẽ có lỗi:</li></ul><p><img src=\"https://images.viblo.asia/78ab0728-307a-4efe-984c-00cddf7907fd.png\" alt=\"\" /></p><ul><li>Chạy <code>git add .</code> sau đó kiểm tra bằng lệnh <code>npx lint-staged</code> sẽ có lỗi:</li></ul><p><img src=\"https://images.viblo.asia/aca53da8-e94a-4411-9aa5-292fa2049987.png\" alt=\"\" /></p><ul><li>Như vậy nếu commit code thì sẽ bị lỗi vì code chưa clean, lỗi như sau:</li></ul><p><img src=\"https://images.viblo.asia/a6d33e9e-8383-4aa8-a955-da686de9de34.png\" alt=\"\" /></p><ul><li>Vì vậy để commit được code mình cần chỉnh sửa lại file lỗi được thông báo như sau:<br/><strong>app.component.ts</strong></li></ul><p><img src=\"https://images.viblo.asia/3b3ceca9-a882-478f-9f82-5906f48cd002.png\" alt=\"\" /></p><ul><li>Và kết quả là mình đã commit được code sau khi chỉnh sửa:</li></ul><p><img src=\"https://images.viblo.asia/34220d1c-3883-4ab3-904d-095aa0762273.png\" alt=\"\" /></p><h2 id=\"tngkt\">Tổng kết</h2><p>Vậy là chúng ta đã tìm hiểu xong cách để configure eslint + prettier + husky + lint-staged cho một project Angular. Hy vọng bài viết này sẽ giúp ích cho các bạn xóa bỏ nỗi lo <strong><em>Clean Code</em></strong> và có những dòng code thật đẹp và gọn gàng trong project của mình. <strong>Chúc các bạn thành công!!!</strong></p>","title":"Cách để setup dự án Angular với eslint + prettier + husky + lint-staged","tags":["@front","@angular","@configure-project","@eslint","@prettier"],"created_at":1691739020000,"updated_at":1691983266000,"comments":[]}